grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
W0424 05:10:01.636020 24815 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 7.0, Driver API Version: 11.7, Runtime API Version: 11.7
W0424 05:10:01.637034 24815 gpu_resources.cc:164] device: 0, cuDNN Version: 8.4.
I0424 05:10:05.483289 24815 build_cinn_pass.cc:702] --- [build_cinn_pass] detected 77 cinn supported subgraphs
W0424 05:10:05.548045 24815 tensor.cc:405] The `is_initialized` method is deprecated since version 2.3, and will be removed in version 2.4! Please use `initialized` method instead.
I0424 05:10:05.548338 24815 program_interpreter.cc:221] New Executor is Running.
I0424 05:11:19.947780 24815 chrometracing_logger.cc:46] writing profiling data to ./profiler_data/resnet18/nvidia/bs8_withcinn_time_2024_04_24_05_11_19_947530.paddle_trace.json
all prim enabled:  True
all prim enabled:  True
all prim enabled:  True
--[check_cinn_ouput] cinn result right.
--[benchmark] benchmark nocinn
--[benchmark] Run for 50 times, the average latency is:4.528160 ms
--[benchmark] benchmark cinn
--[benchmark] Run for 50 times, the average latency is:4.359598 ms
--[profile] profile cinn
============================================Perf Summary============================================
Time Unit: s, IPS Unit: steps/s
|                 |       avg       |       max       |       min       |
|    batch_cost   |     0.10212     |     0.93941     |     0.00436     |
|       ips       |     9.79221     |    229.29953    |     1.06449     |
-------------------Device Summary-------------------
------------------------------  --------------------  
Device                          Utilization (%)       
------------------------------  --------------------  
CPU(Process)                    200.00                
CPU(System)                     14.75                 
GPU0                            43.11                 
------------------------------  --------------------  
Note:
CPU(Process) Utilization = Current process CPU time over all cpu cores / elapsed time, so max utilization can be reached 100% * number of cpu cores.
CPU(System) Utilization = All processes CPU time over all cpu cores(busy time) / (busy time + idle time).
GPU Utilization = Current process GPU time / elapsed time.
----------------------------------------------------


---------------------------------------------Overview Summary---------------------------------------------
Time unit: ms
-------------------------  -------------------------  -------------------------  -------------------------  
Event Type                 Calls                      CPU Time                   Ratio (%)                  
-------------------------  -------------------------  -------------------------  -------------------------  
ProfileStep                2                          12.76                      100.00                     
  PythonUserDefined        2                          12.70                      99.52                      
  Forward                  2                          12.59                      98.68                      
  UserDefined              6                          11.55                      90.52                      
  Operator                 398                        11.22                      87.89                      
  OperatorInner            796                        10.56                      82.72                      
  CudaRuntime              1008                       2.78                       21.75                      
-------------------------  -------------------------  -------------------------  -------------------------  
                           Calls                      GPU Time                   Ratio (%)                  
-------------------------  -------------------------  -------------------------  -------------------------  
  Memset                   40                         0.07                       0.53                       
  Memcpy                   82                         0.25                       1.94                       
  Kernel                   192                        5.50                       43.11                      
-------------------------  -------------------------  -------------------------  -------------------------  
Note:
In this table, We sum up all collected events in terms of event type.
The time of events collected on host are presented as CPU Time, and as GPU Time if on device.
Events with different types may overlap or inclusion, e.g. Operator includes OperatorInner, so the sum of ratios is not 100%.
The time of events in the same type with overlap will not calculate twice, and all time is summed after merged.
Example:
Thread 1:
  Operator: |___________|     |__________|
Thread 2:
  Operator:   |____________|     |___|
After merged:
  Result:   |______________|  |__________|

----------------------------------------------------------------------------------------------------------


-----------------------------------------------Model Summary-----------------------------------------------
Time unit: ms
---------------  ------  ----------------------------------------  ----------------------------------------  
Name             Calls   CPU Total / Avg / Max / Min / Ratio(%)    GPU Total / Avg / Max / Min / Ratio(%)    
---------------  ------  ----------------------------------------  ----------------------------------------  
ProfileStep      2       12.76 / 6.38 / 6.71 / 6.05 / 100.00       5.50 / 2.75 / 2.75 / 2.75 / 100.00        
  Forward        2       12.59 / 6.30 / 6.62 / 5.98 / 98.68        5.50 / 2.75 / 2.75 / 2.75 / 100.00        
  Others         -       0.17 / - / - / - / 1.32                   0.00 / - / - / - / 0.00                   
---------------  ------  ----------------------------------------  ----------------------------------------  
Note:
In this table, GPU time is the sum of all device(GPU) events called in the phase.
Unlike overview summary, if two device(GPU) events execute on different streams with overlap time, we sum them directly here.

-----------------------------------------------------------------------------------------------------------


----------------------------------------------------------------------Operator Summary----------------------------------------------------------------------
Time unit: ms
----------------------------------------------------  ------  ----------------------------------------  ----------------------------------------  ----------  
Name                                                  Calls   CPU Total / Avg / Max / Min / Ratio(%)    GPU Total / Avg / Max / Min / Ratio(%)    FLOPs       
----------------------------------------------------  ------  ----------------------------------------  ----------------------------------------  ----------  
-----------------------------------------------------------------Thread: All threads merged-----------------------------------------------------------------
conv2d                                                40      4.25 / 0.11 / 0.20 / 0.08 / 28.10         4.67 / 0.12 / 0.20 / 0.03 / 66.98         0           
  infer_shape                                         40      0.18 / 0.00 / 0.01 / 0.00 / 4.19          0.00 / 0.00 / 0.00 / 0.00 / 0.00          -           
  compute                                             40      3.92 / 0.10 / 0.19 / 0.07 / 92.22         4.67 / 0.12 / 0.20 / 0.03 / 100.00        -           
    void cudnn::winograd_nonfused::winogradForwar...  6       - / - / - / - / -                         0.06 / 0.01 / 0.01 / 0.01 / 1.34          -           
    void cudnn::winograd_nonfused::winogradForwar...  6       - / - / - / - / -                         0.40 / 0.07 / 0.07 / 0.07 / 8.66          -           
    volta_sgemm_32x128_nn                             6       - / - / - / - / -                         0.66 / 0.11 / 0.11 / 0.11 / 14.18         -           
    void cudnn::winograd_nonfused::winogradForwar...  6       - / - / - / - / -                         0.07 / 0.01 / 0.01 / 0.01 / 1.40          -           
    void cudnn::ops::nchwToNhwcKernel<float, floa...  10      - / - / - / - / -                         0.10 / 0.01 / 0.02 / 0.00 / 2.04          -           
    void cask_cudnn::computeOffsetsKernel<false, ...  12      - / - / - / - / -                         0.04 / 0.00 / 0.00 / 0.00 / 0.91          -           
    volta_scudnn_128x32_sliced1x4_ldg4_relu_exp_s...  2       - / - / - / - / -                         0.05 / 0.03 / 0.03 / 0.03 / 1.12          -           
    void cudnn::ops::nhwcToNchwKernel<float, floa...  6       - / - / - / - / -                         0.03 / 0.01 / 0.01 / 0.00 / 0.72          -           
    volta_scudnn_128x32_sliced1x4_ldg4_relu_exp_m...  4       - / - / - / - / -                         0.45 / 0.11 / 0.11 / 0.11 / 9.63          -           
    void cudnn::winograd::generateWinogradTilesKe...  20      - / - / - / - / -                         0.15 / 0.01 / 0.01 / 0.00 / 3.11          -           
    volta_scudnn_winograd_128x128_ldg1_ldg4_relu_...  20      - / - / - / - / -                         2.02 / 0.10 / 0.11 / 0.09 / 43.30         -           
    void cudnn::cnn::kern_precompute_indices<fals...  2       - / - / - / - / -                         0.01 / 0.00 / 0.00 / 0.00 / 0.15          -           
    void precomputed_convolve_sgemm<float, 1024, ...  2       - / - / - / - / -                         0.06 / 0.03 / 0.03 / 0.03 / 1.24          -           
    volta_scudnn_128x128_relu_interior_nn_v1          2       - / - / - / - / -                         0.06 / 0.03 / 0.03 / 0.03 / 1.24          -           
    volta_scudnn_128x32_relu_medium_nn_v1             2       - / - / - / - / -                         0.20 / 0.10 / 0.10 / 0.10 / 4.21          -           
    volta_scudnn_128x64_relu_medium_nn_v1             2       - / - / - / - / -                         0.31 / 0.16 / 0.16 / 0.16 / 6.74          -           
cinn_launch                                           154     6.96 / 0.05 / 0.29 / 0.02 / 46.01         1.15 / 0.01 / 0.13 / 0.00 / 16.51         0           
  infer_shape                                         154     0.16 / 0.00 / 0.00 / 0.00 / 2.32          0.00 / 0.00 / 0.00 / 0.00 / 0.00          -           
  compute                                             154     6.30 / 0.04 / 0.28 / 0.02 / 90.41         1.15 / 0.01 / 0.13 / 0.00 / 100.00        -           
cinn_instruction_run                                  204     3.92 / 0.02 / 0.09 / 0.01 / 25.89         1.15 / 0.01 / 0.07 / 0.00 / 16.51         0           
  infer_shape                                         204     0.56 / 0.00 / 0.01 / 0.00 / 14.34         0.00 / 0.00 / 0.00 / 0.00 / 0.00          -           
  compute                                             204     2.96 / 0.01 / 0.08 / 0.01 / 75.44         1.15 / 0.01 / 0.07 / 0.00 / 100.00        -           
    MEMSET                                            40      - / - / - / - / -                         0.07 / 0.00 / 0.00 / 0.00 / 5.91          -           
    MEMCPY_DtoD                                       82      - / - / - / - / -                         0.25 / 0.00 / 0.00 / 0.00 / 21.49         -           
    fn_broadcast_to_24_elementwise_add_25_30_kernel   2       - / - / - / - / -                         0.01 / 0.00 / 0.00 / 0.00 / 0.63          -           
    volta_sgemm_64x32_sliced1x4_nn                    2       - / - / - / - / -                         0.03 / 0.01 / 0.01 / 0.01 / 2.52          -           
    void splitKreduce_kernel<32, 16, int, float, ...  2       - / - / - / - / -                         0.01 / 0.00 / 0.00 / 0.00 / 0.82          -           
    void cudnn::ops::pooling_fw_4d_kernel<float, ...  2       - / - / - / - / -                         0.01 / 0.01 / 0.01 / 0.01 / 1.30          -           
    fn_reshape_0_reshape_1_reshape_2_reshape_3_br...  2       - / - / - / - / -                         0.01 / 0.01 / 0.01 / 0.01 / 0.99          -           
    fn_fill_constant_4_fill_constant_8_pow_9_25_k...  2       - / - / - / - / -                         0.01 / 0.00 / 0.00 / 0.00 / 0.63          -           
    fn_reshape_0_reshape_1_reshape_2_reshape_3_br...  16      - / - / - / - / -                         0.16 / 0.01 / 0.02 / 0.00 / 14.02         -           
    fn_fill_constant_4_fill_constant_8_pow_9_19_k...  16      - / - / - / - / -                         0.06 / 0.00 / 0.00 / 0.00 / 4.84          -           
    fn_reshape_0_reshape_1_reshape_2_reshape_3_re...  6       - / - / - / - / -                         0.06 / 0.01 / 0.01 / 0.01 / 4.87          -           
    fn_fill_constant_9_fill_constant_18_pow_19_39...  6       - / - / - / - / -                         0.02 / 0.00 / 0.00 / 0.00 / 1.58          -           
    fn_fill_constant_8_fill_constant_16_pow_17_38...  6       - / - / - / - / -                         0.02 / 0.00 / 0.01 / 0.00 / 2.12          -           
    fn_reshape_0_reshape_1_reshape_2_reshape_3_br...  8       - / - / - / - / -                         0.15 / 0.02 / 0.03 / 0.01 / 12.98         -           
    fn_fill_constant_4_fill_constant_8_pow_9_20_k...  10      - / - / - / - / -                         0.04 / 0.00 / 0.00 / 0.00 / 3.11          -           
    void cudnn::ops::pooling_fw_4d_kernel<float, ...  2       - / - / - / - / -                         0.12 / 0.06 / 0.06 / 0.06 / 10.05         -           
    fn_reshape_0_reshape_1_reshape_2_reshape_3_br...  2       - / - / - / - / -                         0.14 / 0.07 / 0.07 / 0.07 / 12.14         -           
----------------------------------------------------  ------  ----------------------------------------  ----------------------------------------  ----------  


---------------------------------------------------------------Kernel Summary---------------------------------------------------------------
Time unit: ms
------------------------------------------------------------------------------------------  ------  ----------------------------------------  
Name                                                                                        Calls   GPU Total / Avg / Max / Min / Ratio(%)    
------------------------------------------------------------------------------------------  ------  ----------------------------------------  
volta_scudnn_winograd_128x128_ldg1_ldg4_relu_tile148t_nt_v1                                 20      2.02 / 0.10 / 0.11 / 0.09 / 36.73         
volta_sgemm_32x128_nn                                                                       6       0.66 / 0.11 / 0.11 / 0.11 / 12.03         
volta_scudnn_128x32_sliced1x4_ldg4_relu_exp_medium_nhwc_tn_v1                               4       0.45 / 0.11 / 0.11 / 0.11 / 8.17          
void cudnn::winograd_nonfused::winogradForwardFilter4x4<float, float>                       6       0.40 / 0.07 / 0.07 / 0.07 / 7.34          
volta_scudnn_128x64_relu_medium_nn_v1                                                       2       0.31 / 0.16 / 0.16 / 0.16 / 5.71          
volta_scudnn_128x32_relu_medium_nn_v1                                                       2       0.20 / 0.10 / 0.10 / 0.10 / 3.57          
fn_reshape_0_reshape_1_reshape_2_reshape_3_broadcast_to_5_scale_7_fill_constant_10_pow_...  16      0.16 / 0.01 / 0.02 / 0.00 / 2.93          
fn_reshape_0_reshape_1_reshape_2_reshape_3_broadcast_to_5_scale_7_fill_constant_10_pow_...  8       0.15 / 0.02 / 0.03 / 0.01 / 2.71          
void cudnn::winograd::generateWinogradTilesKernel<0, float, float>                          20      0.15 / 0.01 / 0.01 / 0.00 / 2.64          
fn_reshape_0_reshape_1_reshape_2_reshape_3_broadcast_to_5_scale_7_fill_constant_10_pow_...  2       0.14 / 0.07 / 0.07 / 0.07 / 2.54          
void cudnn::ops::pooling_fw_4d_kernel<float, float, cudnn::maxpooling_func<float, float...  2       0.12 / 0.06 / 0.06 / 0.06 / 2.10          
void cudnn::ops::nchwToNhwcKernel<float, float, float, false, true, (cudnnKernelDataTyp...  10      0.10 / 0.01 / 0.02 / 0.00 / 1.73          
void cudnn::winograd_nonfused::winogradForwardOutput4x4<float, float>                       6       0.07 / 0.01 / 0.01 / 0.01 / 1.19          
void cudnn::winograd_nonfused::winogradForwardData4x4<float, float>                         6       0.06 / 0.01 / 0.01 / 0.01 / 1.14          
volta_scudnn_128x128_relu_interior_nn_v1                                                    2       0.06 / 0.03 / 0.03 / 0.03 / 1.05          
void precomputed_convolve_sgemm<float, 1024, 5, 5, 4, 3, 3, 1, false>                       2       0.06 / 0.03 / 0.03 / 0.03 / 1.05          
fn_reshape_0_reshape_1_reshape_2_reshape_3_reshape_4_reshape_5_reshape_6_reshape_7_broa...  6       0.06 / 0.01 / 0.01 / 0.01 / 1.02          
fn_fill_constant_4_fill_constant_8_pow_9_19_kernel                                          16      0.06 / 0.00 / 0.00 / 0.00 / 1.01          
volta_scudnn_128x32_sliced1x4_ldg4_relu_exp_small_nhwc_tn_v1                                2       0.05 / 0.03 / 0.03 / 0.03 / 0.95          
void cask_cudnn::computeOffsetsKernel<false, false>                                         12      0.04 / 0.00 / 0.00 / 0.00 / 0.77          
fn_fill_constant_4_fill_constant_8_pow_9_20_kernel                                          10      0.04 / 0.00 / 0.00 / 0.00 / 0.65          
void cudnn::ops::nhwcToNchwKernel<float, float, float, true, false, (cudnnKernelDataTyp...  6       0.03 / 0.01 / 0.01 / 0.00 / 0.61          
volta_sgemm_64x32_sliced1x4_nn                                                              2       0.03 / 0.01 / 0.01 / 0.01 / 0.53          
fn_fill_constant_8_fill_constant_16_pow_17_38_kernel                                        6       0.02 / 0.00 / 0.01 / 0.00 / 0.44          
fn_fill_constant_9_fill_constant_18_pow_19_39_kernel                                        6       0.02 / 0.00 / 0.00 / 0.00 / 0.33          
void cudnn::ops::pooling_fw_4d_kernel<float, float, cudnn::averpooling_func<float, true...  2       0.01 / 0.01 / 0.01 / 0.01 / 0.27          
fn_reshape_0_reshape_1_reshape_2_reshape_3_broadcast_to_5_scale_7_fill_constant_10_pow_...  2       0.01 / 0.01 / 0.01 / 0.01 / 0.21          
void splitKreduce_kernel<32, 16, int, float, float, float, float, true, false, false>       2       0.01 / 0.00 / 0.00 / 0.00 / 0.17          
fn_broadcast_to_24_elementwise_add_25_30_kernel                                             2       0.01 / 0.00 / 0.00 / 0.00 / 0.13          
fn_fill_constant_4_fill_constant_8_pow_9_25_kernel                                          2       0.01 / 0.00 / 0.00 / 0.00 / 0.13          
void cudnn::cnn::kern_precompute_indices<false>                                             2       0.01 / 0.00 / 0.00 / 0.00 / 0.13          
------------------------------------------------------------------------------------------  ------  ----------------------------------------  


-------------------------------------------UserDefined Summary-------------------------------------------
Time unit: ms
-------------  ------  ----------------------------------------  ----------------------------------------  
Name           Calls   CPU Total / Avg / Max / Min / Ratio(%)    GPU Total / Avg / Max / Min / Ratio(%)    
-------------  ------  ----------------------------------------  ----------------------------------------  
---------------------------------------Thread: All threads merged----------------------------------------
resent18 eval  2       12.70 / 6.35 / 6.67 / 6.03 / 99.52        5.82 / 2.91 / 2.91 / 2.90 / 100.00        



